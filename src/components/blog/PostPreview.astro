---
import { Translate } from "astro-localization";

var lmap = {};

const { post } = Astro.props;

function getLocalizedLabel(prop, locale) {
	if (prop && typeof prop === 'object' && !Array.isArray(prop) && prop[locale]) {
		return prop[locale];
	}

	return prop;
}

function addLocalizationsPropToMap(prop, map) {
	if (prop && typeof prop === 'object' && !Array.isArray(prop)) {
		var langs = Object.keys(prop);

		langs.forEach(function (lang) {
			map[lang] = {};
		});
	}
}

addLocalizationsPropToMap(post.title, lmap);
addLocalizationsPropToMap(post.description, lmap);

var locales = Object.keys(lmap);

if (post.title) {
	locales.forEach(function (locale) {
		lmap[locale].title = getLocalizedLabel(post.title, locale);
	});
}

if (post.description) {
	locales.forEach(function (locale) {
		lmap[locale].description = getLocalizedLabel(post.description, locale);
	});
}

---

<!-- https://codepen.io/zank/pen/GRyNeWv?editors=1100 -->
<article>
    <figure>
        <!-- Photo by Quentin Dr on Unsplash -->
        <img
            src="https://images.unsplash.com/photo-1513309914637-65c20a5962e1?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=3450&q=80"
            alt="Several hands holding beer glasses"
        />
        <figcaption>
			<h3><Translate {lmap} key='title' /></h3>
		</figcaption>
    </figure>
    <footer>
		{post.tags && post.tags.map(tag => (
			<a href={`/tags/` + tag}>{tag}</a>)
		)}
		<span>28/03/2022</span>
	</footer>
</article>

<style lang="scss">
	article {
        padding: 0;
		// display: flex;
        // flex-direction: column;
        // justify-content: space-between;
        // padding: 2rem;
        // background: white;
        // border-radius: 1rem;

		figure {
			margin: 0;
			padding: 0;
			// max-height: 20rem;
			// overflow: hidden;
			// position: relative;

			> img {
				width: 100%;
				object-fit: contain;
			}

			> figcaption {
				> h3 {
					padding: 0;
					margin: 0;
				}
			}
		}

		footer {
			// display: flex;
			// flex-direction: column;
		}
	}
</style>
